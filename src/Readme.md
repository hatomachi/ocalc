# MyCalc Spreadsheet for Obsidian

MyCalcは、Obsidian内で軽量なスプレッドシート（表計算）を実現するカスタムプラグインです。
「プレーンテキストのポータビリティ」というObsidianの思想を守りながら、直感的なセルの編集、ドラッグ＆ドロップによる行列操作、そして数式計算を提供します。

## ✨ コンセプト (Philosophy)

1. **データはプレーンテキストで**: 
   独自バイナリではなく「YAMLフロントマター ＋ CSV」のハイブリッド形式（`.mycalc`）でデータを保持します。Gitでのバージョン管理が容易で、他のスクリプトや **LLM（AIアシスタント）からの読み書きも極めて容易** な設計です。
2. **シームレスな体験**: 
   エクセルのような別アプリを開くことなく、Markdownの執筆フローの中でシームレスに表計算を行えます。
3. **ノートへの美しい埋め込み**: 
   計算結果の表は、標準のMarkdownノート（Live Preview / Reading View）に美しく埋め込んで表示できます。

---

## 🚀 主な機能 (Features)

* **スプレッドシートUI**:
  * クリックでの直接セル編集。
  * 最終行での `Enter` キー押下によるシームレスな新規行追加。
* **直感的な行列操作**:
  * 行番号（左端ハンドル）および列ヘッダーの「ドラッグ＆ドロップ」による順番入れ替え。
  * 右クリックのコンテキストメニューによる行・列の追加、削除、名前変更。
* **計算エンジン (Formulas)**:
  * `{単価} * {数量}` のような変数を用いた数式の定義と自動計算。
  * 列名の変更時も、数式内の変数を自動的に追従して書き換えます。
* **スマートな合計行 (Smart Totals)**:
  * 各列の合計値をフッターに表示。
  * クリックで特定の列を合計対象から除外（ON/OFF切替）可能。
  * 文字列が含まれる列は自動的に無視し、安全に計算を行います。
* **ノートへの埋め込み (Embed)**:
  * Markdownコードブロック（` ```mycalc `）を使用して、他のノートに閲覧専用の美しいテーブルとして埋め込み表示が可能。

---

## 📖 使い方 (How to Use)

### ファイルの作成
コマンドパレット（`Ctrl+P` または `Cmd+P`）を開き、**「MyCalc: 新しい計算表 (.mycalc) を作成」** を実行します。

### 基本操作
* **行の操作**: 表の左端にある数字のハンドルを右クリック（追加/削除）、またはドラッグ（移動）します。
* **列の操作**: 列のヘッダー名（「列1」など）を右クリック（変更/数式設定/削除）、またはドラッグ（移動）します。
* **合計の切替**: 表の一番下の合計行の各セルをクリックすると、その列の合計計算のON/OFFが切り替わります。

### 他のノートへの埋め込み表示
任意のMarkdownノートに以下のコードブロックを記述すると、計算結果を含む表がプレビュー表示されます。

\`\`\`markdown
```mycalc
ファイル名.mycalc